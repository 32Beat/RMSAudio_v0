////////////////////////////////////////////////////////////////////////////////
/*
	rmsdelay_t
	
	Created by 32BT on 15/11/15.
	Copyright Â© 2015 32BT. All rights reserved.
*/
////////////////////////////////////////////////////////////////////////////////

#include "rmsdelay_t.h"
#include <math.h>

////////////////////////////////////////////////////////////////////////////////
#pragma mark
////////////////////////////////////////////////////////////////////////////////

rmsdelay_t RMSDelayNew(void)
{ return RMSBufferNew(1024*1024); }

////////////////////////////////////////////////////////////////////////////////

void RMSDelayReleaseMemory(rmsdelay_t *delay)
{
	RMSBufferReleaseMemory(delay);
}

////////////////////////////////////////////////////////////////////////////////

float RMSDelayProcessSample(rmsdelay_t *delay, double offset, float feedBack, float S)
{
	float R = RMSBufferGetSampleWithDelay(delay, offset);
	
	S += feedBack * R;

	RMSBufferSetSample(delay, S);
	delay->index++;
	
	return R - feedBack * S;
	
	return S;
}

////////////////////////////////////////////////////////////////////////////////



